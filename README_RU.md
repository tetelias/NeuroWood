    Этот репозиторий содержит решение хакатона NeuroWood.

Обучение основано на модели "tf_efficientnetv2_s_in21ft1k" из библиотеки "timm". Данная модель была в начале обучена на датасете
Imagenet21k, а потом дообучена на Imagenet1k, что улучшает обобщающую способность моделей. Разнообразные аугментации из 
библиотеки Albumentation были использованы, чтобы не предотвратить переобучение. Еще одним средством борьбы с данным явлением
является техника fmix, когда два изображения объединяются в одно на основе маски с плавными границами, а функция потерь 
считается в условиях отнесения получившегося изображения к обоим классам, но пропорционально доли площади каждого в площади 
объединения. Для ускорения обучения был использован режим OneCycle.

Для успешного выполнения экспериментов и предсказания предполагается, что данные хакатона расположены в папке "data/", которая
содержит подпапки "1", "3", "drova", "test" and "test_top_scores". Семантически предоставленные изображения не очень разнообразны,
а важнейшие элементы, влияющие на отнесение к тому или иному классу, имеют большие размеры, поэтому имеет смысл проводить обучение
на уменьшенных изображениях. Был выбран размер (512, 512), а изображения были преобразованы самым простым способом: сначала оно было
сжато так, что минимальная сторона приняла размер 512 пикселей, а потом было обрезано до такого же размера вдоль большей стороны.

Созданы тесты, подтверждающие корректную предобработку данных и их подготовку к обучению.

Для повторения экспериментов и подготовки предсказаний в файле "data/test.csv" необходимо выполнить:
```
docker run -it --gpus device=0 --name pytorch --shm-size 16gb -v ${PWD}:/workspace tetelias/conda-pytorch:v1 bash run-training-then-submit.sh
```

Если нужно только подготовить предсказаний в файле "test.csv", то необходимая команда:
```
docker run -it --gpus device=0 --name pytorch --shm-size 16gb -v ${PWD}:/workspace tetelias/conda-pytorch:v1 bash run-submit.sh
```

После окончания соревнования организаторы предоставили дополнительный датасет, который расположен в папке "data/test_top_scores". Для получения
предсказаний по этим данным нужно убрать знак комментария в последней строке обоих исполняемых скриптов, и файл "data/test_top_scores.csv"
будет подготовлен.